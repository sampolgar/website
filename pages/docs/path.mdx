# Building in public

## Tech skills to demonstrate

- Typescript, Node.js, npm packages
- The Graph, Dune analytics, blockchain data APIs
- Bigquery, SQL, noSQL
- REST, GraphQL API
- AWS infrastructure, Docker, Github Action
- Solidity, Hardhat, Ethers.js, ZK
- Circom
- Rust

## Features

- fetching data on-chain for DID. e.g. if user has token assign badge
- building sdk
- building npm package

## 24/1

## 26/1

- Task: Write a contract that receives a minimum usd amount of eth and allows only the contract creator to withdraw.
- Challenge: write from scratch w/o looking at solution
- Patrick C Course [here](https://youtu.be/gyMwXuJrbJQ?t=18281)

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

import "@chainlink/contracts/src/v0.8/interfaces/AggregatorV3Interface.sol";

contract FundMe {

    address internal owner;
    constructor(){
        owner = msg.sender;
    }

    uint256 public minimumUsd = 1* 1e18;
    //create funders array and a map between funder and funding amount
    address[] public funders;
    mapping(address => uint256) addressToFundingAmount;


    function fund() public payable{
        require(convertEthToUsd(msg.value) >= minimumUsd, "sorry, not enough");
        funders.push(msg.sender);
        addressToFundingAmount[msg.sender] = msg.value;
    }

    //converted is in usd
    function convertEthToUsd(uint256 ethAmount) public view returns(uint256){
        uint256 ethPrice = getEthPrice();
        uint256 converted = (ethPrice * ethAmount) / 1e18;
        return converted;
    }

    //eth price is in Wei 1624,2249276800,00000000
    function getEthPrice() public view returns(uint256){
        AggregatorV3Interface chainlinkPrice = AggregatorV3Interface(0xD4a33860578De61DBAbDc8BFdb98FD742fA7028e);
        (,int256 answer, , , ) = chainlinkPrice.latestRoundData();
        return uint256(answer * 1e10);
    }

    function withdraw() public ownerCheck {
        //recreate the funders list
        funders = new address[](0);
        // then use the call to remove the funds from the contract
        (bool sent, ) = payable(owner).call{value: address(this).balance}("");
        require(sent, "sending failed");
    }

    modifier ownerCheck {
        require(msg.sender == owner, "sorry mate, not you");
        _;
    }

    function getContractBalance() public view returns(uint256) {
        uint256 currentBal = address(this).balance;
        return currentBal;
    }
}

```

## 27/1

- [x] Write a contract that receives a minimum usd amount of eth and allows only the contract creator to withdraw
- [x] Think about what NPM packages I can build
- [] Think about what tutorial I can build

### NPM package ideas

1. Simplified web3 library abstracting complex aspects of web3.js
2. NPM module for creating tokens, nft's, dapps, etc
3. NPM module for creating a gated community allowing sismo badge holders access
4. DID protocol with key requirement variables
5. create a token gated community website generator e.g. disqus

### Tutorial ideas

1. create a token gated community website
2. create a token gated community website generator

### Notes from today

- using `ethers` to create an encrypted json key from .env file [link](https://youtu.be/gyMwXuJrbJQ?t=28054)
- using `process.env.PRIVATE_KEY` with key in .env file or key sent in cmd execution e.g. `PRIVATE_KEY=MYPRIVATEKEY node index.js`

## 28/1

- [x] in ethers - write the storage contract
- [x] in ethers - write a contract that receives a minimum usd amount of eth and allows only the contract creator to withdraw.

### Notes from today

- using `solc` to compile contracts from `.sol` to `.bin` + `.abi` to deploy with ethers `const factory = new ethers.ContractFactory(abi, binary, wallet)`
- needed specific version i.e. `yarn add solc@0.8.7-fixed`
- `yarn solcjs --bin --abi --include-path node_modules/ --base-path . -o . SimpleStorage.sol`
- add this to your scripts file e.g. scripts: `{"compile": "yarn...... SimpleStorage.sol"}`
- using ethers, a `provider` class connects you to the network, a `signer` has direct/indirect access to private key to authorize charges & actions, `contract` is the contract obj
- wasting time on the typescript tutorial, I'll change to javascript

### Hardhat

- if running `npx hardhat` doesn't return the hardhat creation prompts, check for parent `hardhat.config.js` file and remove it or run `npx hardhat --verbose`
- hardhat uses built in network by default => config in hardhat.config.js e.g. `module.exports = {defaultNetwork: "hardhat"}`
- or execute via cmd `yarn hardhat run scripts/deploy.js --network hardhat`
- `yarn hardhat` brings up tasks e.g. run or custom task
- `yarn hardhat console` brings up the js console to execute
- [open zeppelin ref](https://docs.openzeppelin.com/learn/deploying-and-interacting)

### chai

- execute specific tests with `yarn hardhat test --grep update-when-test`
- execute specific test by changing `it("should...` to `it.only("should...`

```javascript
describe('SimpleStorage', function () {
  let SimpleStorageFactory, simpleStorage;
  beforeEach(async function () {
    simpleStorageFactory = await ethers.getContractFactory('SimpleStorage');
    simpleStorage = await simpleStorageFactory.deploy();
  });

  it('should start with a favorite number 0', async function () {
    const currentValue = await simpleStorage.retrieve();
    console.log(`current value is ${currentValue}`);
    const expectedValue = '0';
    assert.equal(currentValue.toString(), expectedValue);
  });

  it('should update when we store a number', async function () {
    const valUpdated = 5;
    const res = await simpleStorage.store(valUpdated);
    await res.wait(1);

    const valReturned = await simpleStorage.retrieve();
    console.log(` -------- ${valReturned}`);
    assert.equal(valUpdated, valReturned);
  });
});
```

## 29/1

## Notes from today

- really good github readme [link](https://github.com/othneildrew/Best-README-Template)
- hardhat typescript support requires `yarn add --dev @types/mocha @types/node @typechain/hardhat @typechain/ethers-v5 ts-node typechain typescript`
- Typescript needs correct typing on contracts, `typechain` and `typechain/hardhat` creates ts bindings automatically
- - `yarn hardhat typechain`

## 30/1

### complete the below w/o github copilot [link](https://youtu.be/gyMwXuJrbJQ?t=34728)

-[x] create the SimpleStorage contract that stores a fav number, retreives the number, and stores an array of person structs (name, favnum)
-[x] create a hardhat deployment script to deploy the SimpleStorage contract on Goerli
-[x] verify it on Etherscan
-[x] interact with it
-[x] Deploy the contract to hardhat network to view transactions on the console chain
-[x] Deploy the contract to the Goerli testnet and verify it on Etherscan
-[x] create a task to check the block number
-[x] create tests for the contract
-[x] check with coverage
-[x] work with gas reporter in tests, check usd price with coinmarketcap
-[] update to Typescript

### Notes



Next
-[] create the Todo contract that stores an array of todo's add, get, update, delete

-[]

Current strategy
1. watch tutorial while following along and pausing
2. try to replicate in 1 go
3. 

Proposed strategy
1. watch tutorial 3 speed and take note of high level tasks
2. try to replicate each high level task
3. 

