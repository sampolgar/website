# Building in public

## Tech skills needed

| Hard skill          | Competency 1 - 5 | Fluency 1 - 5 |
| ------------------- | ---------------- | ------------- |
| TypeScript          | 2                | 1             |
| Solidity            | 1                |               |
| Rust                |                  |               |
| NPM                 | 3                | 1             |
| HardHat             | 1                |               |
| Foundry             |                  |               |
| Ethersjs            | 1                |               |
| Circom              |                  |               |
| The Graph           |                  |               |
| Dune Analytics      |                  |               |
| Blockchain data API | 1                |               |
| Bigquery            |                  |               |
| SQL                 | 2                | 2             |
| NoSQL               | 2                | 2             |
| REST                | 2                | 2             |
| GraphQL             | 1                |               |
| Docker              |                  |               |
| GitHub Action       | 1                | 1             |
| AWS                 | 2                | 1             |

# Week 1 24/1 - 29/1

## 24/1

highly recommended [Patrick free code camp 32 hr tutorial](https://www.youtube.com/watch?v=gyMwXuJrbJQ&t), let's start with that.

### Notes

- bored watching tutorial and following along. Not sure how much I'm picking up. I'll try to do the tutorial without looking at the solution and see how far I get
- [x] create a simple storage contract

## 26/1

-[x] Write a contract that receives a minimum usd amount of eth and allows only the contract creator to withdraw. -[x] write from scratch w/o looking at solution

## 27/1

- [x] Write a contract that receives a minimum usd amount of eth and allows only the contract creator to withdraw
- [x] Think about what NPM packages I can build
- [x] Think about what tutorial I can build

### NPM package ideas

1. Simplified web3 library abstracting complex aspects of web3.js
2. NPM module for creating tokens, nft's, dapps, etc
3. NPM module for creating a gated community allowing sismo badge holders access
4. DID protocol with key requirement variables
5. create a token gated community website generator e.g. disqus

### Tutorial ideas

1. create a token gated community website
2. create a token gated community website generator

### Notes from today

- using `ethers` to create an encrypted json key from .env file [link](https://youtu.be/gyMwXuJrbJQ?t=28054)
- using `process.env.PRIVATE_KEY` with key in .env file or key sent in cmd execution e.g. `PRIVATE_KEY=MYPRIVATEKEY node index.js`

## 28/1

- [x] in ethers - write the storage contract
- [x] in ethers - write a contract that receives a minimum usd amount of eth and allows only the contract creator to withdraw

### Notes from today

- using `solc` to compile contracts from `.sol` to `.bin` + `.abi` to deploy with ethers `const factory = new ethers.ContractFactory(abi, binary, wallet)`
- needed specific version i.e. `yarn add solc@0.8.7-fixed`
- `yarn solcjs --bin --abi --include-path node_modules/ --base-path . -o . SimpleStorage.sol`
- add this to your scripts file e.g. scripts: `{"compile": "yarn...... SimpleStorage.sol"}`
- ethers, a `provider` is the network node, a `signer` is the private key of the wallet that deploys the contract, `contract` is the contract obj
- wasting time on the typescript tutorial, I'll change to javascript

### Hardhat

- if running `npx hardhat` doesn't return the hardhat creation prompts, check for parent `hardhat.config.js` file and remove it or run `npx hardhat --verbose`
- hardhat uses built in network by default => config in hardhat.config.js e.g. `module.exports = {defaultNetwork: "hardhat"}`
- or execute via cmd `yarn hardhat run scripts/deploy.js --network hardhat`
- `yarn hardhat` brings up tasks e.g. run or custom task
- `yarn hardhat console` brings up the js console to execute
- [open zeppelin ref](https://docs.openzeppelin.com/learn/deploying-and-interacting)

### chai

- execute specific tests with `yarn hardhat test --grep update-when-test`
- execute specific test by changing `it("should...` to `it.only("should...`
- tests use `beforeEach` to execute the contract creation before calling each `it`

```javascript
describe('SimpleStorage', function () {
  let SimpleStorageFactory, simpleStorage;
  beforeEach(async function () {
    simpleStorageFactory = await ethers.getContractFactory('SimpleStorage');
    simpleStorage = await simpleStorageFactory.deploy();
  });

  it('should start with a favorite number 0', async function () {
    const currentValue = await simpleStorage.retrieve();
    console.log(`current value is ${currentValue}`);
    const expectedValue = '0';
    assert.equal(currentValue.toString(), expectedValue);
  });

  it('should update when we store a number', async function () {
    const valUpdated = 5;
    const res = await simpleStorage.store(valUpdated);
    await res.wait(1);

    const valReturned = await simpleStorage.retrieve();
    console.log(` -------- ${valReturned}`);
    assert.equal(valUpdated, valReturned);
  });
});
```

## 29/1

## Notes from today

- really good github readme [link](https://github.com/othneildrew/Best-README-Template)
- hardhat typescript support requires `yarn add --dev @types/mocha @types/node @typechain/hardhat @typechain/ethers-v5 ts-node typechain typescript`
- Typescript needs correct typing on contracts, `typechain` and `typechain/hardhat` creates ts bindings automatically
- - `yarn hardhat typechain`

## Week 1 wrap up

- focused too much on getting through the tutorial and not enough practice
- writing 1 contract and working through hardhat won't improve competency / fluency on solidity. Need to dedicate more chunked time to practice individual skills rather than watching a tutorial with everything

# Week 2 30/1 - 5/2

### Skills to practice

| Hard skill | Competency 1 - 5 | Fluency 1 - 5 |
| ---------- | ---------------- | ------------- |
| TypeScript | 2                | 1             |
| Solidity   | 1                |               |
| HardHat    | 1                |               |
| Ethersjs   | 1                |               |

### Goals

- complete up to hour 10 of the tutorial without looking at the solution
- find how I can improve fluency on TypeScript and Solidity

## 30/1

### complete the below w/o github copilot [link](https://youtu.be/gyMwXuJrbJQ?t=34728)

-[] create the SimpleStorage contract that stores a fav number, retreives the number, and stores an array of person structs (name, favnum)
-[] create a hardhat deployment script to deploy the SimpleStorage contract on Goerli
-[] verify it on Etherscan in the code
-[] interact with it
-[] Deploy the contract to hardhat network to view transactions on the console chain
-[] Deploy the contract to the Goerli testnet and verify it on Etherscan
-[] create a task to check the block number
-[] create tests for the contract
-[] check with coverage
-[] work with gas reporter in tests, check usd price with coinmarketcap api
-[] update to Typescript

#### round 1 completed - 5 hours

#### round 2 completed - 3 hours

### Notes

##### question

- Why does hre.run return `HardhatError: HH303: Unrecognized task verify: verify` but `run` doesn`t.

```js
const verify = async (contractAddress, args) => {
  await hre.run('verify: verify', {});
};
```

## Changing learning strategy

1. watch tutorial while following along and pausing (1.5 hr tutorial)
2. try to replicate

Proposed strategy

1. skip over whole tutorial quickly
2. watch tutorial in 10-15 minute segments
3. replicate each 10-15 segment before moving forwards
4. repeat

## 31/1

- [progress point](https://youtu.be/gyMwXuJrbJQ?t=38398)

1. change from deployment script to hardhat-deploy
2. copy the Aave format for helper-hardhat-config to enable different chain deployment.
3. update contract constructor and variables for different chain deployment
4. create a mock chainlink contract for hardhat network
5. use tags to deploy on different networks

- make the constructor dynamic for the pricefeed address (if different chains required) e.g.

```
AggregatorV3Interace public priceFeedAddress;
constructor(address _priceFeedAddress) { priceFeedAddress = AggregatorV3Interface(_priceFeedAddress); }
```

- add tags to deployment script to test / deploy different networks
- test the mock deployment in hardhat with the mock chainlink contract
  `module.exports.tags = ["all", "mocks"]`
  `yarn hardhat deploy --tags mocks`

- code style in solidity [details](https://youtu.be/gyMwXuJrbJQ?t=39633)

## 1/2

### notes from today

- testing with ethereum waffle
- transaction test cases with `Arrange`, `Act`, `Assert` pattern
- debugging objects with javascript debugger
- console.log in solidity with hardhat console.log `import "hardhat/console.sol";`
- `process.exit(0))` to exit the script succesfully. `process.exit(1)` to exit with error

## Storage (gas optimization), [current link](https://youtu.be/gyMwXuJrbJQ?t=43817)

- `constant` and `immutable` variables are stored in bytecode (a pointer to )
- variables are stored in storage (a pointer to the blockchain)
- gas storage details found [here](https://github.com/crytic/evm-opcodes)
- prepend `s_` to variables appending to storage. e.g. `uint256 s_favNum;` (because storage is expensive)
- rather than having public `s_favNum` variable, create a public function to return the value. e.g. `function getFavNum() public view returns (uint256) { return s_favNum; }`
- rather than throwing an error with text e.g. `require(msg.sender == owner, "sorry, you can't do that");`, use an error code with `revert` =>

```solidity
error FundMe__NotOwner();
modifier errorOrNot(){
  if (msg.sender != i_owner) revert FundMe__NotOwner();
}
```

## 2/2

Time to create my own contract from something I was thinking of, a community with members, members and friend each other.

### draft 1

```solidity
contract CommunityMember {
  //make friend
  //make post w price
  //like post - can't like own post
  //buy post from someone
  //remove friend
}

contract ASingleCommunity {
    //add member
    //set membership payable
    //remove member
    //get list of members
    //
    //make group
    //make group admin
    //transfer group admin
    //
}

contract AllCommunities {
    //new member
    //remove member
    //get list of members
    //mapping member address and member name => mapping(address => string)
    //get list of friends - mapping address to name => mapping(address => mapping(address => ))

    //create community
    //get a community
    //get all communities
}
```

### draft 2 (simplify)

```solidity
contract CommunityMember {
  //make friend
  //remove friend
  //make post - add to post map, convert string to hex
  //like post - can't like own post, add to like map

  //------non essential
  //buy post from someone
}

contract AllCommunities {
    //new member
    //remove member
    //get list of members -- mapping member address and member name => mapping(address => string)
    //get list of a members friends -- mapping address to name => mapping(address => mapping(address => ))

    //------non essential
    //get a list of posts of 1 member - mapping address to posts => mapping(address => mapping(contentAddress => ))
    //get a list of post likes of 1 member - mapping address to likes => mapping(address => contentAddress)
}
```

- soft delete https://stackoverflow.com/questions/48515633/deleting-mapping-from-mapping-in-solidity

## 3/2

- initial values for data types (used when checking a mapping(address => bool)) https://ethereum.stackexchange.com/questions/40559/what-are-the-initial-zero-values-for-different-data-types-in-solidity

## 4/2

What's not working and why

## Types containing (nested) mappings can only be parameters or return variables of internal or library functions.

- the Member can't be stored in memory because it has a mapping
- mapping is not allowed in memory because map locations are stored at random in storage [details](https://ethereum.stackexchange.com/questions/107027/how-to-return-an-array-of-structs-that-has-mappings-nested-within-them)

```solidity
  struct Member {
      address memberAddress;
      string name;
      address[] friends;
      mapping(address => bool) friendsMap;
  }

  function getMemberByAddress(address _i) mustBeMember public view returns(Member memory){
        uint256 memberPosition = membersMap[_i];
        return membersArray[memberPosition];
  }
```

#### Question

```solidity

    struct MemberMatch {
        uint256 arrayPos;
        bool memberExists;
    }
    mapping(address => MemberMatch) public amembersMap;

    or this

    mapping(address => uint256) internal membersMap;
    mapping(address => bool) internal memberExists;
```

## Week 2 wrap up

- spent 3 days on the community contract, amongst other things
- need to have a faster learning velocity to improve
- plan for next week = find a way to increase learning velocity on contracts & typescript
-

# Week 2 30/1 - 5/2

### Skills to practice

| Hard skill | Competency 1 - 5 | Fluency 1 - 5 |
| ---------- | ---------------- | ------------- |
| TypeScript | 2                | 1             |
| Solidity   | 1                |               |
| HardHat    | 1.5              |               |
| Ethersjs   | 1.5              |               |

# Week 3: 6/2 - 12/2

## 7/2 deploy my community contract with hardhat

### Exercise

- contracts
- scripts / deploy.ts
- test Community.ts
- hardhat config, add etherscan, add solidity compiler, add typechain, add gas reporter, add coverage, add waffle, add chai, add dynamic chain support

### I didn't

1. wait for 5 block confirmations before verifying
2. create a utils file for verification
3. use hardhat deploy
4. use solhint
5. didn't create a task

## 8/2

1. starting leetcode for 4 hrs a day to increase learning velocity on typescript and solidity
2. finding a way to contribute to sismo

### AM

- [1](https://leetcode.com/problems/fruit-into-baskets/)
- [2](https://leetcode.com/problems/the-k-strongest-values-in-an-array/)

### PM

- Community project in hardhat
- Read Sismo docs

### notes from the day

- use solhint => yarn solhint contracts/Community.sol. solhint provides error messages you see in remix via the command line
- moving to hardhat deploy starts [here](https://youtu.be/gyMwXuJrbJQ?t=36650)

Error message
Property 'attach' is missing in type 'ContractFactory any[], BaseContract'
but required in type 'Community**factory'.ts(2741)
Community**factory.ts(189, 12): 'attach' is declared here.

What does this mean?
deployer = (await getNamedAccounts()).deployer

- using the getNamedAccounts function from hardhat-deploy
- returns a promised object with named accounts

## 9/2

- I found leetcode to include bad questions which I wasted hours on. Algoexpert has better quality questions and I'm going to use that instead
- I signed up for my Masters in CS but not sure I'm doing the right thing. Orientation was boring
- Need to write a 2 page thesis proposal for my Masters in CS

## 11/2

### AM

TS
[https://www.algoexpert.io/questions/two-number-sum](2 number sum) round1
1st time = 3 hours

1. brute force - double nested for loop
2. make map, loop through array and check if target - current number is in map e.g. current = 3, target = 5, 5 - 3 = 2, check if 2 is in map, if it is, return [3, 2], if not, add 3 to map
3. sort and use 2 pointers

## 12/2

### AM

[https://www.algoexpert.io/questions/two-number-sum](2 number sum) round 2
2nd time = 2 hours

1. my 2nd array loop starts back at 1. why? I'm not sure but I should base the 2nd loop iterator on the first i.e. `j = i + 1`
2. was fine
3. while loop was wrong. I was checking for successful match and then incrementing pointers. My while loop should check for invalid, incremenet pointers inside then check for valid again outside while

[https://www.algoexpert.io/questions/validate-subsequence](subsequence validation) round 1
1st time = 1.5 hours

## 13/2

### AM

[https://www.algoexpert.io/questions/two-number-sum](2 number sum) round 3
3rd time = 45 minutes

1. easy
2. easy
3. while loop was wrong and got stuck. While loop again checked for successful match (same mistake as yesterday)... I should check (while left pointer is smaller than right)

[https://www.algoexpert.io/questions/validate-subsequence](subsequence validation) round 2
1st time = 1 hour

- spent most of the time iterating from array pointer rather than sequence pointer

### PM

1. Look into Sismo & zk privacy preserving protocols to understand how to contribute
2. Look into Twitter API

- disorganized "looking", will do again tomorrow with more structure e.g. hypothesis driven research rather than bottom up

## 14/2

### AM

[https://www.algoexpert.io/questions/two-number-sum](2 number sum) round 3
3rd time = 15 minutes

1. easy
2. easy
3. easy

[https://www.algoexpert.io/questions/validate-subsequence](subsequence validation) round 3
3rd time = 10 minutes

[https://www.algoexpert.io/questions/tournament-winner](tournament winner) round 1
1st time = 45 minutes

[https://www.algoexpert.io/blockchain/solidity-fundamentals/assessment/1](q1 assessment) round 1
1st time = 1 hour. I am tired and spent too long deciding what data structure I'll use.

### PM

Writing

1. plan for day (AM/PM)
2. day notes (AM/PM)
3. day review + tomorrow plan
4. update twitter

Week

1. plan for week in relation to competency/fluency towards web3 TS eng + 3 axis approach
2. review week

## 15/2

- https://www.algoexpert.io/questions/find-closest-value-in-bst
  I iterated through the bst, added all items to a map, made an array with the map and sorted it, then found the clostest value.
- iterate through bst = O(n) time, O(n) space and add items to map
- map to array = O(n)
- sort array = O(n log n)
- find closest value = O(n)

This is a crazy solution

- doesn't take the BST property into account (left is smaller than root, right is bigger than root)
- doesn't take into account that the BST is sorted

## 19/2

- https://www.algoexpert.io/questions/find-closest-value-in-bst

## 20/2

### AM

-[x] TS practice, Solidity practice -[x] create mock API for Sismo (needs improving)
https://pipedream.com/@dylburger/mock-a-rest-api-with-pipedream-p_pWCnBq/readme
https://github.com/cowprotocol/ts-dune-client/blob/main/src/queryParameter.ts
https://dune.com/queries/156895

-[x] https://www.algoexpert.io/questions/find-closest-value-in-bst -[x]complete both recursive and iterative solutions
-[]https://www.algoexpert.io/questions/node-depths

### PM

- sismo
- uni

## Question

What's the difference between calling return on a recursive function and not calling return?

- Return uses the results of the function in the next iteration of the function.
- Not calling with return could instead for example, update a global var
- Think about the factorial (1 x 2 x 3 x 4 x 5)

```ts
function factorial(n: number): number {
  if (n === 0) {
    return 1;
  } else {
    return n * factorial(n - 1);
  }
}

const result: number = factorial(5);
console.log(result); //120
```

```ts
function printNumbers(n: number): void {
  if (n === 0) {
    return;
  } else {
    console.log(n);
    printNumbers(n - 1);
  }
}

printNumbers(5);
```

- in `branch sums`, summing the BST branches, I don't need to return the bstRecurse because I'm not using the result of the sum in the next iteration (I'm just adding the sum and adding it to the sum array)
- in `find closest value in BST`, I'm using the running sum of each bst search to compare it to the proceeding sums.

Given a class

```ts
class BinaryTree {
  value: number;
  left: BinaryTree | null;
  right: BinaryTree | null;

  constructor(value: number) {
    this.value = value;
    this.left = null;
    this.right = null;
  }
}
```

1. create an interface for a node
2. create an array of nodes using spread operator
3. pop a node object off and destructure it

```ts
//1 => each node is either the class left or right and needs `BinaryTree | null` otherwise error =  Type 'BinaryTree | null' is not assignable to type 'BinaryTree'.
interface Node {
  node: BinaryTree | null;
  depth: number;
}

//2
let nodes: Node[] = [
  { node: tree, depth: 0 },
  { node: tree.left, depth: 1 },
  { node: tree.right, depth: 1 },
];

let stack: Node[] = [];
stack.push(...nodes);

//3
let { node, depth } = stack.pop()!; /// without the ! I get Property 'node' does not exist on type 'Node | undefined'. because we define the Node as being a tree or null.
```

#### logic returns errors

For the Binary Tree class above, the following function returns
`Function lacks ending return statement and return type does not include 'undefined'.`
`Object is possibly 'null'.`

```ts
function recurseHandler(tree: BinaryTree | null, depthSum: number): number {
  if (tree === null) {
    return (
      depthSum +
      recurseHandler(tree.left, depthSum + 1) +
      recurseHandler(tree.right, depthSum + 1)
    );
  }
}
```

- function lacks ending return statement because there's nothing after the if statement
- I'm saying that tree is null, but then I'm trying to access tree

solution

```ts
function recurseHandler(tree: BinaryTree | null, depthSum: number): number {
  if (tree === null) return 0;
  return (
    depthSum +
    recurseHandler(tree.left, depthSum + 1) +
    recurseHandler(tree.right, depthSum + 1)
  );
}
```

## 21/2

### AM

- TS practice, Solidity practice
- create static generator with API key for Sismo
- create dynamic (daily group generation) generator with API key for Sismo
  https://pipedream.com/@dylburger/mock-a-rest-api-with-pipedream-p_pWCnBq/readme
  https://github.com/cowprotocol/ts-dune-client/blob/main/src/queryParameter.ts
  https://dune.com/queries/156895

### PM

### review

- better work in the morning than afternoon. I was easily distracted in the PM.
- I'll start working out around midday and going to the library in the afternoon to continue focus

Notes

### difference between `forEach` and `for...of`

- `for...of` is preferred for iterating arrays of objects
- `for...of` can `break` out of a loop and stop processing the rest of the array
- `forEach` can only `return` which stops processing the current iteration and moves to the next element

```ts
// for...of
const: numbers[]: number[] = [ 1, 2, 3];
for (const number of numbers) {
  if (number === 2) break;
}

// forEach
numbers.forEach((number) => {
  if (number === 2) return; // error
})
```

## Difference between

`export interface ResultMetadata {}`
and
`export type ResultMetadata = {}`

- Interface can be extended by other interfaces and classes, types can't be extended
  e.g.

```ts
interface A {
  a: string;
}

interface B extends A {
  b: string;
}
```

## how to typecast

```ts
interface PersonFirst {
  name: string;
  age: number;
}

interface PersonSecond {
  name: string;
  age: number;
}

const personFirst: PersonFirst = { name: 'Alice', age: 30 };

const personSecond = personFirst as PersonSecond; // using the as keyword

// or

const person2 = <Person>myObj; // using the angle bracket syntax
```

## how to use type guards

https://medium.com/@wujido20/runtime-types-in-typescript-5f74fc9dc6c4
https://ivov.dev/notes/typescript-and-set-theory

## Question

How does the type work [here](https://medium.com/@maksim_smagin/how-good-is-your-typescript-interview-with-just-3-questions-cecdce5ce4d4)?

```ts
type DeepPartial<T> = {
  [P in keyof T]?: DeepPartial<T[P]>;
};

function find<T>(criteria: DeepPartial<T>): T[] {
  ...
}

type User = {
  id: number;
  name: string;
  address: {
    country: string;
    city: string;
    house: string;
    zipcode: string;
  };
};

const users = find({
  address: { coutry: 'UK' }
});
```

## 22/2

### AM

- TS practice, Solidity practice

### PM

-[x] create static generator with API key for Sismo

- needed to execute process.env.MY_API_KEY as terminal variables e.g. `MY_API_KEY=1234 yarn generate-group ...`

```ts
  public constructor() {
    this.url = 'https://eoytk2wrnwx0j2c.m.pipedream.net';
    this.restProvider = new RestProvider();
    this.headers = {
      'x-dune-api-key': process.env.MY_API_KEY as string,       //both work but the second is better
      'x-dune-api-key': DuneAnalyticsProvider.getAPIKey(),
    };
  }
```

### review

## 23/2

### AM

- TS practice, solidity practice

### PM

- Sismo dune provider handling execution wait time

### notes

#### Truthy vs Non Truthy

Non Truthy

- bool('') = false
- bool(0) = false
- bool(-0) = false
- bool(NaN) = false
- bool(null) = false
- bool(undefined) = false
- bool(false) = false
- false or null when coerced into a boolean value using the ! (not) operator

#### if(myString) vs while(myString) vs while(!!myString)

- `let myString = ""`
- `if(myString)` is falsy in a boolean contex because the value of myString is an empty string
- `while(myString)`, is evaluated differently. It's not checking whether the value of myString is truthy or falsy, it's checking if the value myString exists. Even if it exists as an empty string, it is truthy because it exists
- `while(!!myString)` is checking the value of myString the same as `if(myString)`
- This is called "coercing" a value into a boolean value

examples

```ts
!!"" = false
!!"hello" = true // compiles to true = true because the string is type set to a bool
```

```ts
let myString = 'hello';

while (myString) {
  console.log(myString);
  myString.slice(1);
}
//hello, ello, llo, lo, o, undefined
```

```ts
while (!!myString) {
  console.log(myString);
  myString.slice(1);
}
console.log(`ended`);

//hello, ello, llo, lo, o, ended
```

#### getting stuck on recursive problems, writing here my instructions for next time

1. Start with the base case

- What stops the algo?
- What's the simplest thing that can stop it?
- Is my Algo going to reach it or run indefinately?

2. What are the smaller sub-problems?
3. how does the recursive step combine the solutions into the original problem?
4. if stuck, draw a recursive tree

```python
def factorial(n):
    if n == 0:
        return 1
    else:
        return n * factorial(n - 1)
```

factorial(4)
|
|--> factorial(3)
| |
| |--> factorial(2)
| | |
| | |--> factorial(1)
| | | |
| | | |--> factorial(0)
| | | | |
| | | | |--> return 1
| | | |
| | | |--> return 1
| | |
| | |--> return 2
| |
| |--> return 6
|
|--> return 24
